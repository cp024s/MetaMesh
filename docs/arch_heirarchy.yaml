NPU_TOP (system integrator)
├─ HOST_IF (host control & regfile)
│  ├─ AXI-Lite Regfile / MMIO
│  ├─ Job Queue / Doorbell
│  ├─ Interrupt Controller
│  └─ Debug Access (trace readout)
├─ JOB_SCHED (graph & tile scheduler)
│  ├─ Graph Readiness Tracker
│  ├─ Tile Generator (H, W, C tiling)
│  ├─ Resource Allocator (clusters, DMA, banks)
│  └─ Prefetch Policy Engine
├─ MICROSEQ (micro-op engine)
│  ├─ Micro-op ROM / RAM
│  ├─ Decoder / Dispatcher
│  ├─ Loop counters & branch logic
│  └─ Event & Completion Unit (DMA_DONE / CLUSTER_DONE)
├─ DMA_CTRL (data movement)
│  ├─ SG Engine (descriptor parser)
│  ├─ Address Generator (nested loop engine)
│  ├─ AXI Master Read Path
│  ├─ AXI Master Write Path
│  └─ Prefetch Controller / Throttler
├─ ONCHIP_MEM (banked SRAM fabrics)
│  ├─ Bank Controller / Arbiter
│  ├─ Activation Buffer(s)
│  ├─ Weight Buffer(s)
│  ├─ Accumulator / Output Buffers
│  └─ ECC / BIST hooks
├─ COMPUTE_CLUSTER [one or more]
│  ├─ CLUSTER_CTRL (local controller)
│  ├─ PE_ARRAY (rows × cols)
│  │  ├─ PE (Processing Element) [MAC, RF, activation, quant]
│  │  ├─ Local operand RFs
│  │  └─ Intra-PE streaming links (row/col)
│  ├─ Reduction Network (adder tree / streaming)
│  └─ Local SRAM / RF controller (tile-local)
├─ INTERCONNECT / NOC (optional)
│  ├─ Router / Crossbar
│  ├─ VC & Flow Control
│  └─ QoS Arbiter
├─ PMU (power & clock mgmt)
│  ├─ Clock Gating Controller
│  ├─ Power Gating Interface
│  └─ Thermal & DVFS Hooks
└─ DEBUG & PERF
   ├─ Trace Buffer (event tokens)
   ├─ Perf Counters (PE util, DMA BW, bank conflicts)
   └─ JTAG / Test Interfaces
